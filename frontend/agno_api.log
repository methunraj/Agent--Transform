2025-06-09 11:37:58,873 - __main__ - INFO - üì• Enhanced processing request for: Siemens_Report_FY2024.pdf (mode: auto)
2025-06-09 11:37:58,878 - __main__ - INFO - üìä Processing JSON data: 2,823 characters, mode: auto
2025-06-09 11:37:58,887 - __main__ - INFO - Created enhanced Agno agent with model: gemini-2.5-flash-preview-05-20, mode: auto
2025-06-09 11:37:59,004 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-06-09 11:38:02,823 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent "HTTP/1.1 200 OK"
2025-06-09 11:38:02,839 - google_genai.models - INFO - AFC remote call 1 is done.
2025-06-09 11:38:03,773 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-06-09 11:38:13,471 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent "HTTP/1.1 500 Internal Server Error"
2025-06-09 11:38:13,477 - __main__ - INFO - Operation completed in 14.59 seconds
2025-06-09 11:38:13,478 - __main__ - ERROR - ‚ùå Enhanced Agno processing error: <Response [500 Internal Server Error]>
2025-06-09 11:38:13,492 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/google/gemini.py", line 237, in invoke
    return self.get_client().models.generate_content(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        model=self.id,
        ^^^^^^^^^^^^^^
        contents=formatted_messages,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **request_kwargs,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/models.py", line 5977, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/models.py", line 4940, in _generate_content
    response_dict = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/_api_client.py", line 785, in request
    response = self._request(http_request, stream=False)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/_api_client.py", line 714, in _request
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/errors.py", line 103, in raise_for_response
    raise ServerError(status_code, response_json, response)
google.genai.errors.ServerError: 500 INTERNAL. {'error': {'code': 500, 'message': 'An internal error has occurred. Please retry or report in https://developers.generativeai.google/guide/troubleshooting', 'status': 'INTERNAL'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/methunraj/Desktop/WebApp/python_agent_api/main.py", line 342, in enhanced_convert_json_with_agno
    response = agent.run(prompt)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/agent/agent.py", line 1079, in run
    raise last_exception
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/agent/agent.py", line 1040, in run
    response = self._run(
        run_response=run_response,
    ...<5 lines>...
        messages=messages,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/agent/agent.py", line 651, in _run
    model_response: ModelResponse = self.model.response(
                                    ~~~~~~~~~~~~~~~~~~~^
        messages=run_messages.messages,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        response_format=response_format,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/base.py", line 321, in response
    assistant_message, has_tool_calls = self._process_model_response(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        messages=messages,
        ^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        tool_choice=tool_choice or self._tool_choice,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/base.py", line 521, in _process_model_response
    response = self.invoke(
        messages=messages,
    ...<2 lines>...
        tool_choice=tool_choice or self._tool_choice,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/google/gemini.py", line 245, in invoke
    raise ModelProviderError(
    ...<4 lines>...
    ) from e
agno.exceptions.ModelProviderError: <Response [500 Internal Server Error]>

2025-06-09 11:38:13,492 - __main__ - WARNING - ‚ö†Ô∏è Enhanced Agno failed, using enhanced fallback: Enhanced Agno AI processing failed: <Response [500 Internal Server Error]>
2025-06-09 11:38:13,893 - __main__ - INFO - Enhanced direct conversion completed in 0.40s
2025-06-09 11:38:54,185 - __main__ - INFO - üìÅ File download: Siemens_Report_FY2024pdf_enhanced.xlsx (direct_fallback)
2025-06-10 10:24:41,046 - __main__ - INFO - üì• Enhanced processing request for: Siemens_Report_FY2024.pdf (mode: auto)
2025-06-10 10:24:41,051 - __main__ - INFO - üìä Processing JSON data: 16,028 characters, mode: auto
2025-06-10 10:24:41,061 - __main__ - INFO - Created enhanced Agno agent with model: gemini-2.5-pro-preview-05-06, mode: auto
2025-06-10 10:24:41,202 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-06-10 10:25:36,726 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro-preview-05-06:generateContent "HTTP/1.1 200 OK"
2025-06-10 10:25:36,744 - google_genai.models - INFO - AFC remote call 1 is done.
2025-06-10 10:25:37,196 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-06-10 10:28:32,186 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro-preview-05-06:generateContent "HTTP/1.1 200 OK"
2025-06-10 10:28:32,201 - google_genai.models - INFO - AFC remote call 1 is done.
2025-06-10 10:28:32,233 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-06-10 10:29:49,579 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro-preview-05-06:generateContent "HTTP/1.1 200 OK"
2025-06-10 10:29:49,601 - google_genai.models - INFO - AFC remote call 1 is done.
2025-06-10 10:29:50,635 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-06-10 10:30:11,141 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro-preview-05-06:generateContent "HTTP/1.1 200 OK"
2025-06-10 10:30:11,160 - google_genai.models - INFO - AFC remote call 1 is done.
2025-06-10 10:30:11,964 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-06-10 10:31:32,480 - httpx - INFO - HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro-preview-05-06:generateContent "HTTP/1.1 500 Internal Server Error"
2025-06-10 10:31:32,501 - __main__ - INFO - Operation completed in 411.44 seconds
2025-06-10 10:31:32,501 - __main__ - ERROR - ‚ùå Enhanced Agno processing error: <Response [500 Internal Server Error]>
2025-06-10 10:31:32,529 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/google/gemini.py", line 237, in invoke
    return self.get_client().models.generate_content(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        model=self.id,
        ^^^^^^^^^^^^^^
        contents=formatted_messages,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **request_kwargs,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/models.py", line 5977, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/models.py", line 4940, in _generate_content
    response_dict = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/_api_client.py", line 785, in request
    response = self._request(http_request, stream=False)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/_api_client.py", line 714, in _request
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/errors.py", line 103, in raise_for_response
    raise ServerError(status_code, response_json, response)
google.genai.errors.ServerError: 500 INTERNAL. {'error': {'code': 500, 'message': 'An internal error has occurred. Please retry or report in https://developers.generativeai.google/guide/troubleshooting', 'status': 'INTERNAL'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/methunraj/Desktop/WebApp/python_agent_api/main.py", line 342, in enhanced_convert_json_with_agno
    response = agent.run(prompt)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/agent/agent.py", line 1079, in run
    raise last_exception
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/agent/agent.py", line 1040, in run
    response = self._run(
        run_response=run_response,
    ...<5 lines>...
        messages=messages,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/agent/agent.py", line 651, in _run
    model_response: ModelResponse = self.model.response(
                                    ~~~~~~~~~~~~~~~~~~~^
        messages=run_messages.messages,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        response_format=response_format,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/base.py", line 321, in response
    assistant_message, has_tool_calls = self._process_model_response(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        messages=messages,
        ^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        tool_choice=tool_choice or self._tool_choice,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/base.py", line 521, in _process_model_response
    response = self.invoke(
        messages=messages,
    ...<2 lines>...
        tool_choice=tool_choice or self._tool_choice,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/google/gemini.py", line 245, in invoke
    raise ModelProviderError(
    ...<4 lines>...
    ) from e
agno.exceptions.ModelProviderError: <Response [500 Internal Server Error]>

2025-06-10 10:31:32,529 - __main__ - WARNING - ‚ö†Ô∏è Enhanced Agno failed, using enhanced fallback: Enhanced Agno AI processing failed: <Response [500 Internal Server Error]>
2025-06-10 10:31:32,530 - __main__ - ERROR - Enhanced direct conversion failed: Extra data: line 1 column 16028 (char 16027)
2025-06-10 10:31:32,530 - __main__ - ERROR - ‚ùå Enhanced processing error: Enhanced direct conversion failed: Extra data: line 1 column 16028 (char 16027)
2025-06-10 10:31:32,534 - __main__ - ERROR - Traceback: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/google/gemini.py", line 237, in invoke
    return self.get_client().models.generate_content(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        model=self.id,
        ^^^^^^^^^^^^^^
        contents=formatted_messages,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **request_kwargs,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/models.py", line 5977, in generate_content
    response = self._generate_content(
        model=model, contents=contents, config=parsed_config
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/models.py", line 4940, in _generate_content
    response_dict = self._api_client.request(
        'post', path, request_dict, http_options
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/_api_client.py", line 785, in request
    response = self._request(http_request, stream=False)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/_api_client.py", line 714, in _request
    errors.APIError.raise_for_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/google/genai/errors.py", line 103, in raise_for_response
    raise ServerError(status_code, response_json, response)
google.genai.errors.ServerError: 500 INTERNAL. {'error': {'code': 500, 'message': 'An internal error has occurred. Please retry or report in https://developers.generativeai.google/guide/troubleshooting', 'status': 'INTERNAL'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/methunraj/Desktop/WebApp/python_agent_api/main.py", line 342, in enhanced_convert_json_with_agno
    response = agent.run(prompt)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/agent/agent.py", line 1079, in run
    raise last_exception
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/agent/agent.py", line 1040, in run
    response = self._run(
        run_response=run_response,
    ...<5 lines>...
        messages=messages,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/agent/agent.py", line 651, in _run
    model_response: ModelResponse = self.model.response(
                                    ~~~~~~~~~~~~~~~~~~~^
        messages=run_messages.messages,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        response_format=response_format,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/base.py", line 321, in response
    assistant_message, has_tool_calls = self._process_model_response(
                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        messages=messages,
        ^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        tool_choice=tool_choice or self._tool_choice,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/base.py", line 521, in _process_model_response
    response = self.invoke(
        messages=messages,
    ...<2 lines>...
        tool_choice=tool_choice or self._tool_choice,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/agno/models/google/gemini.py", line 245, in invoke
    raise ModelProviderError(
    ...<4 lines>...
    ) from e
agno.exceptions.ModelProviderError: <Response [500 Internal Server Error]>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/methunraj/Desktop/WebApp/python_agent_api/main.py", line 429, in enhanced_process_json_data
    ai_response = enhanced_convert_json_with_agno(
        request.json_data,
    ...<5 lines>...
        request.chunk_size
    )
  File "/Users/methunraj/Desktop/WebApp/python_agent_api/main.py", line 353, in enhanced_convert_json_with_agno
    raise Exception(f"Enhanced Agno AI processing failed: {str(e)}")
Exception: Enhanced Agno AI processing failed: <Response [500 Internal Server Error]>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/methunraj/Desktop/WebApp/python_agent_api/main.py", line 158, in enhanced_direct_json_to_excel
    data = json.loads(json_data)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/json/decoder.py", line 348, in decode
    raise JSONDecodeError("Extra data", s, end)
json.decoder.JSONDecodeError: Extra data: line 1 column 16028 (char 16027)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/methunraj/Desktop/WebApp/python_agent_api/main.py", line 481, in enhanced_process_json_data
    file_id, xlsx_filename, file_path, proc_time = enhanced_direct_json_to_excel(
                                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        request.json_data,
        ^^^^^^^^^^^^^^^^^^
        request.file_name,
        ^^^^^^^^^^^^^^^^^^
        request.chunk_size
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/methunraj/Desktop/WebApp/python_agent_api/main.py", line 224, in enhanced_direct_json_to_excel
    raise Exception(f"Enhanced direct conversion failed: {str(e)}")
Exception: Enhanced direct conversion failed: Extra data: line 1 column 16028 (char 16027)

